(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{449:function(t,s,a){"use strict";a.r(s);var r=a(44),v=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[a("strong",[t._v("大致概括就是：")])]),t._v(" "),a("ul",[a("li",[t._v("轮询、长轮询，长连接")]),t._v(" "),a("li",[t._v("websocket")])]),t._v(" "),a("h2",{attrs:{id:"ajax轮询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ajax轮询"}},[t._v("#")]),t._v(" AJAX轮询")]),t._v(" "),a("ul",[a("li",[t._v("客户端定时通过ajax查询服务端，服务器收到请求后立马返回响应信息并关闭连接")])]),t._v(" "),a("p",[t._v("优点：实现简单"),a("br"),t._v("\n缺点：加重网络负载，浪费带宽和服务器资源")]),t._v(" "),a("h2",{attrs:{id:"长轮询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#长轮询"}},[t._v("#")]),t._v(" 长轮询")]),t._v(" "),a("p",[a("strong",[t._v("AJAX的长轮询：")]),a("br"),t._v("\n客户端发送请求，但是服务器会阻塞请求，直到有数据传递或超时才返回"),a("br"),t._v("\n客户端收到数据后，再次发送请求，建立连接")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("http和jsonp方式的长轮询"),a("br"),t._v("\n把script标签附加到页面上让脚本执行。服务器挂起连接直到有事件发生，\n将脚本内容返回给浏览器，然后打开另一个script标签获取下一个事件，\n从而实现长轮询")])]),t._v(" "),a("li",[a("p",[t._v("xhr长轮询"),a("br"),t._v("\n客户端发送ajax请求等待响应"),a("br"),t._v("\n服务器做特殊处理挂起请求，触发事件才会返回数据并关闭请求"),a("br"),t._v("\n客户端收到信息，再次请求，这样循环下去")])])]),t._v(" "),a("p",[t._v("优点：错误处理和超时管理方便，不会频繁请求"),a("br"),t._v("\n缺点：客户端发起连接过多时服务器具有风险，且挂起请求过多仍然浪费资源")]),t._v(" "),a("h2",{attrs:{id:"长连接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#长连接"}},[t._v("#")]),t._v(" 长连接")]),t._v(" "),a("ul",[a("li",[t._v("页面嵌套隐藏的iframe，它的src属性设置为一个长连接请求，服务器就能源源不断传输数据")])]),t._v(" "),a("p",[t._v("优点：消息即时传递，不发无用请求"),a("br"),t._v("\n缺点：长连接消耗服务器资源")]),t._v(" "),a("h2",{attrs:{id:"websocket"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#websocket"}},[t._v("#")]),t._v(" WebSocket")]),t._v(" "),a("p",[a("strong",[t._v("1.握手环节验证服务器是否支持websocket：")])]),t._v(" "),a("ul",[a("li",[t._v("浏览器访问服务端后，浏览器生成一个随机字符串")]),t._v(" "),a("li",[t._v("浏览器将随机字符串放在http协议头内发送给服务器")]),t._v(" "),a("li",[t._v("服务端和客户端都对字符串进行处理：跟magic string(固定的)拼接后加密")]),t._v(" "),a("li",[t._v("服务器将加密字符串放在http头内返回给浏览器，进行比对，判断是否一致")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" ws "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WebSocket")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ws://127.0.0.1:8080/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("strong",[t._v("2.数据收发环节：")])]),t._v(" "),a("ul",[a("li",[t._v("加密传输，客户端和服务端连接后默认不断开连接")])])])}),[],!1,null,null,null);s.default=v.exports}}]);